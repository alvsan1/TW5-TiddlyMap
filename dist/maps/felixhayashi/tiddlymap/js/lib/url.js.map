{"version":3,"sources":["felixhayashi/tiddlymap/js/lib/url.js"],"names":["Url","url","paths","prefix","i","s","length","isAbsolute","encode","path","join","charAt","slice","split","decode","protocol","toString","user","pass","host","port","query","hash","parse","map","defaultPorts","self","d","document","link","createElement","location","href","auth","match","replace","test","base","basePath","selfPath","props","pop","shift","parseQs","encodeURIComponent","code","hex1","hex2","hex3","n1","parseInt","n2","n3","n","String","fromCharCode","hex","qs","re","exec","key","decodeURIComponent","value","Array","push","clear","Function","count","isEmpty","e","ii","len"],"mappings":"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","file":"../../../../../felixhayashi/tiddlymap/js/lib/url.js","sourcesContent":["// @preserve\n/*\\\n\ntitle: $:/plugins/felixhayashi/tiddlymap/js/URL\ntype: application/javascript\nmodule-type: library\n\n@preserve\n\n\\*/\n\n/*** Code **********************************************************/\n\n/**\n * <<<\n * Lightweight URL manipulation with JavaScript. This library is\n * independent of any other libraries and has pretty simple interface\n * and lightweight code-base. Some ideas of query string parsing\n * had been taken from Jan Wolter.\"\n *\n * @see http://unixpapa.com/js/querystring.html\n * @license MIT\n * @author Mykhailo Stadnyk <mikhus@gmail.com>\n * <<< https://github.com/Mikhus/jsurl\n *\n * @class\n * @param {string} url\n */\nfunction Url( url) {\n  this.paths = function( paths) {\n    var prefix = '', i = 0, s;\n\n    if (paths && paths.length && paths + '' !== paths) {\n      if (this.isAbsolute()) {\n        prefix = '/';\n      }\n\n      for (s = paths.length; i < s; i++) {\n        paths[i] = encode(paths[i]);\n      }\n\n      this.path = prefix + paths.join('/');\n    }\n\n    paths = (this.path.charAt(0) === '/' ?\n      this.path.slice(1) : this.path).split('/');\n\n    for (i = 0, s = paths.length; i < s; i++) {\n      paths[i] = decode(paths[i]);\n    }\n\n    return paths;\n  };\n\n  this.encode = encode;\n  this.decode = decode;\n\n  this.isAbsolute = function() {\n    return this.protocol || this.path.charAt(0) === '/';\n  };\n\n  this.toString = function() {\n    return (\n      (this.protocol && (this.protocol + '://')) +\n      (this.user && (\n        encode(this.user) + (this.pass && (':' + encode(this.pass))\n      ) + '@')) +\n      (this.host && this.host) +\n      (this.port && (':' + this.port)) +\n      (this.path && this.path) +\n      (this.query.toString() && ('?' + this.query)) +\n      (this.hash && ('#' + encode(this.hash)))\n    );\n  };\n\n  parse( this, url);\n}\n\nvar\n    // mapping between what we want and <a> element properties\n  map = {\n    protocol : 'protocol',\n    host     : 'hostname',\n    port     : 'port',\n    path     : 'pathname',\n    query    : 'search',\n    hash     : 'hash'\n  },\n\n  defaultPorts = {\n    'ftp'    : 21,\n    'gopher' : 70,\n    'http'   : 80,\n    'https'  : 443,\n    'ws'     : 80,\n    'wss'    : 443\n  },\n\n  parse = function( self, url) {\n    var\n      d      = document,\n      link   = d.createElement( 'a'),\n      url    = url || d.location.href,\n      auth   = url.match( /\\/\\/(.*?)(?::(.*?))?@/) || [],\n      i\n      ;\n\n    link.href = url;\n\n    for (i in map) {\n      self[i] = link[map[i]] || '';\n    }\n\n      // fix-up some parts\n    self.protocol = self.protocol.replace( /:$/, '');\n    self.query    = self.query.replace( /^\\?/, '');\n    self.hash     = decode(self.hash.replace( /^#/, ''));\n    self.user     = decode(auth[1] || '');\n    self.pass     = decode(auth[2] || '');\n    self.port     = (\n        defaultPorts[self.protocol] == self.port || self.port == 0\n      ) ? '' : self.port; // IE fix, Android browser fix\n\n    if (!self.protocol && !/^([a-z]+:)?\\/\\//.test( url)) {\n        // is IE and path is relative\n      var\n        base     = new Url( d.location.href.match(/(.*\\/)/)[0]),\n        basePath = base.path.split( '/'),\n        selfPath = self.path.split( '/'),\n        props = [ 'protocol','user','pass','host','port' ],\n        s = props.length\n        ;\n\n      basePath.pop();\n\n      for (i = 0; i < s; i++) {\n        self[props[i]] = base[props[i]];\n      }\n\n      while (selfPath[0] == '..') { // skip all \"../\n        basePath.pop();\n        selfPath.shift();\n      }\n\n      self.path =\n          (url.charAt(0) != '/' ? basePath.join( '/') : '') +\n          '/' + selfPath.join( '/')\n        ;\n    }\n\n    else {\n        // fix absolute URL's path in IE\n      self.path = self.path.replace( /^\\/?/, '/');\n    }\n\n    self.paths((self.path.charAt(0) == '/' ?\n        self.path.slice(1) : self.path).split('/')\n      );\n\n    parseQs( self);\n  },\n\n  encode = function(s) {\n    return encodeURIComponent(s).replace(/'/g, '%27');\n  },\n\n  decode = function(s) {\n    s = s.replace( /\\+/g, ' ');\n\n    s = s.replace(/%([ef][0-9a-f])%([89ab][0-9a-f])%([89ab][0-9a-f])/gi,\n        function( code, hex1, hex2, hex3) {\n          var\n            n1 = parseInt( hex1, 16) - 0xE0,\n            n2 = parseInt( hex2, 16) - 0x80\n            ;\n\n          if (n1 == 0 && n2 < 32) {\n            return code;\n          }\n\n          var\n            n3 = parseInt( hex3, 16) - 0x80,\n            n = (n1 << 12) + (n2 << 6) + n3\n            ;\n\n          if (n > 0xFFFF) {\n            return code;\n          }\n\n          return String.fromCharCode( n);\n        }\n      );\n\n    s = s.replace( /%([cd][0-9a-f])%([89ab][0-9a-f])/gi,\n        function( code, hex1, hex2) {\n          var n1 = parseInt(hex1, 16) - 0xC0;\n\n          if (n1 < 2) {\n            return code;\n          }\n\n          var n2 = parseInt(hex2, 16) - 0x80;\n\n          return String.fromCharCode( (n1 << 6) + n2);\n        }\n      );\n\n    s = s.replace( /%([0-7][0-9a-f])/gi,\n        function( code, hex) {\n          return String.fromCharCode( parseInt(hex, 16));\n        }\n      );\n\n    return s;\n  },\n\n  parseQs = function( self) {\n    var qs = self.query;\n\n    self.query = new (function( qs) {\n      var re = /([^=&]+)(=([^&]*))?/g, match;\n\n      while ((match = re.exec( qs))) {\n        var\n          key = decodeURIComponent(match[1].replace(/\\+/g, ' ')),\n          value = match[3] ? decode(match[3]) : ''\n          ;\n\n        if (this[key] != null) {\n          if (!(this[key] instanceof Array)) {\n            this[key] = [ this[key] ];\n          }\n\n          this[key].push( value);\n        }\n\n        else {\n          this[key] = value;\n        }\n      }\n\n      this.clear = function() {\n        for (var key in this) {\n\n          if (!(this[key] instanceof Function)) {\n\n            delete this[key];\n          }\n        }\n      };\n\n      this.count = function() {\n        var count = 0, key;\n        for (key in this) {\n\n          if (!(this[key] instanceof Function)) {\n            count++;\n          }\n        }\n        return count;\n      };\n\n      this.isEmpty = function() {\n        return this.count() === 0;\n      };\n\n      this.toString = function() {\n        var s = '', e = encode, i, ii;\n\n        for (i in this) {\n\n          if (this[i] instanceof Function) {\n            continue;\n          }\n\n\n          if (this[i] instanceof Array) {\n\n            var len = this[i].length;\n\n            if (len) {\n              for (ii = 0; ii < len; ii++) {\n                s += s ? '&' : '';\n\n                s += e( i) + '=' + e( this[i][ii]);\n              }\n            }\n\n            else {\n                // parameter is an empty array, so treat as\n                // an empty argument\n\n              s += (s ? '&' : '') + e( i) + '=';\n            }\n          }\n\n          else {\n            s += s ? '&' : '';\n\n            s += e( i) + '=' + e( this[i]);\n          }\n        }\n\n        return s;\n      };\n    })( qs);\n  }\n  ;\n\n/*** Exports *******************************************************/\n\nexport default Url;\n"],"sourceRoot":"../../../../../../src/plugins"}